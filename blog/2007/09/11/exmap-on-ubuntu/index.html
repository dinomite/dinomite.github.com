<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>EXMAP on Ubuntu « Dinomite.net</title>

  <link href="/stylesheets/all.css" rel="stylesheet" />
  <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/atom.xml" />
  <script src="https://app.chataco.com/assets/inpage/inpage.bundle.js"></script>
</head>

<body>
<div id="main" role="main">
  <nav>
  <ul>
    <li>
      <span class="blog-title"><a class="blog-title" href="/">Dinomite.net</a></span>
      <span class="blog-subtitle">the blog of Drew Stephens</span>
    </li>
  </ul>
</nav>


  <div class="main-content">
    <h1 class="article-title">EXMAP on Ubuntu</h1>
    <div class="article-title-date">Sep 11, 2007</div>
    <p>EXMAP is a shared memory analysis utility that makes it easy to determine exactly how much memory a process is using.  Unlike <code>top</code>, which counts all memory shared amongst programs toward each of those programs, EXMAP gives three numbers most notable of which is &ldquo;Effective Resident&rdquo; memory usage.  This number is the amount of memory mapped directly by a process, plus a portion of any shared memory pools it is part of, that is, the program is only counted as using an equal portion of shared memory as all other processes that are sharing the same.</p>

<p>On my system, both Gaim (Pidgin my foot) and Evolution are using aspell.  In top, they are both responsible for libaspell.so in its entirety, contributing 672K to each of their displayed memory usage.  EXMAP puts 338K towards Gaim and 334K to Evolution, a much more accurate tally, since only a single instance of libaspell is actually in memory, shared by the two other processes.  From my quick testing, it seems that subsequent users of shared memory take the larger share, 4K more in Gaim&rsquo;s case, since I started it after Evolution.  If I close Gaim, Evolution is then credited with the entire 632K of memory that libaspell occupies.</p>

<p>So, on to installing EXMAP which certainly isn&rsquo;t hard, but requires a kernel module which makes it non-trivial.  First, use <code>apt-get</code> (or really, it&rsquo;s better replacement <code>aptitude</code>) to install EXMAP, the required kernel module source and the stuff you&rsquo;ll need to build said module:</p>

<pre>
sudo -i
aptitude install linux-headers-$(uname -r)
aptitude install module-assistant build-essential
aptitude install exmap exmap-modules-source
</pre>

<p>Then, build the EXMAP module:</p>

<pre>
module-assistant prepare
module-assistant update
module-assistant build exmap
module-assistant install exmap
depmod
modprobe exmap
echo exmap >> /etc/modules
</pre>

<p><code>module-assistant</code> automatically compiles and installs the module against the kernel headers that <code>aptitude</code> installed in the previous block and <code>depmod</code> calculates the dependencies amongst all modules, including the new EXMAP one.  <code>modprobe</code> installs the new module into the kernel and adding its name to <code>/etc/modules</code> ensures that it will be ready next time your system restarts as well.  Once all that is done, you can run <code>gexmap</code>.</p>

  </div>

  <sidebar class="sidebar">
  <ul>
    <li><h5 class="heading">See Also</h5></li>
    <li>
      <ol>
        <li><a href="https://twitter.com/dinomite">Twitter</a></li>
        <li><a href="https://github.com/dinomite">GitHub</a></li>
        <li><a href="https://www.flickr.com/photos/dinomite">Flickr</a></li>
        <li><a href="http://pinboard.in/u:dinomite">Pinboard</a></li>
        <li><a href="http://www.last.fm/user/dinomite">Last.fm</a></li>
        <li><a href="http://search.cpan.org/~dinomite/">CPAN</a></li>
      </ol>
    </li>
  </ul>

  <ul>
    <li><h5 class="heading">Recent Articles</h5></li>
    <li>
      <ol>
            <li>
              <a href="/blog/2017/07/15/kotlin-s-let/">Kotlin's let()</a>
              <div class="article-link-date">Jul 15, 2017</div>
            </li>
            <li>
              <a href="/blog/2017/07/12/coding-tests/">Coding Tests</a>
              <div class="article-link-date">Jul 12, 2017</div>
            </li>
            <li>
              <a href="/blog/2017/01/19/jdbi-tips/">JDBI Tips</a>
              <div class="article-link-date">Jan 19, 2017</div>
            </li>
            <li>
              <a href="/blog/2016/09/23/diy-stretch-webbing-leash-a-la-ruffwear-roamer/">DIY Stretch Webbing Leash (à la Ruffwear® Roamer™)</a>
              <div class="article-link-date">Sep 23, 2016</div>
            </li>
            <li>
              <a href="/blog/2016/05/18/optional-authentication-with-dropwizard/">Optional Authentication with Dropwizard</a>
              <div class="article-link-date">May 18, 2016</div>
            </li>
            <li>
              <a href="/blog/2016/05/02/reading-devise-sessions-in-java/">Reading Devise Sessions in Java</a>
              <div class="article-link-date">May  2, 2016</div>
            </li>
            <li>
              <a href="/blog/2016/03/18/better-rails.cache-invalidation-with-quick-queries/">Better Rails.cache Invalidation with Quick Queries</a>
              <div class="article-link-date">Mar 18, 2016</div>
            </li>
            <li>
              <a href="/blog/2016/03/07/winter-tech-forum-is-the-finest/">Winter Tech Forum is The Finest</a>
              <div class="article-link-date">Mar  7, 2016</div>
            </li>
            <li>
              <a href="/blog/2014/12/30/serene-night-biking/">Serene night biking</a>
              <div class="article-link-date">Dec 30, 2014</div>
            </li>
            <li>
              <a href="/blog/2014/04/04/wunderground-with-the-lacrosse-c84612/">Wunderground with the LaCrosse C84612</a>
              <div class="article-link-date">Apr  4, 2014</div>
            </li>
      </ol>
    </li>
  </ul>

  <ul>
    <li><h5 class="heading">Tags</h5></li>
    <li>
      <ol>
            <li><a href="/blog/tags/networking/">Networking (1)</a></li>
            <li><a href="/blog/tags/cars/">Cars (3)</a></li>
            <li><a href="/blog/tags/tech/">Tech (4)</a></li>
            <li><a href="/blog/tags/rails/">Rails (2)</a></li>
            <li><a href="/blog/tags/uncategorized/">Uncategorized (5)</a></li>
            <li><a href="/blog/tags/programming/">Programming (4)</a></li>
            <li><a href="/blog/tags/hiring/">Hiring (1)</a></li>
            <li><a href="/blog/tags/java/">Java (2)</a></li>
            <li><a href="/blog/tags/kotlin/">Kotlin (2)</a></li>
            <li><a href="/blog/tags/dropwizard/">Dropwizard (1)</a></li>
            <li><a href="/blog/tags/politics/">Politics (2)</a></li>
            <li><a href="/blog/tags/linux/">Linux (3)</a></li>
            <li><a href="/blog/tags/computers/">Computers (3)</a></li>
            <li><a href="/blog/tags/biking/">biking (1)</a></li>
            <li><a href="/blog/tags/diy/">DIY (1)</a></li>
            <li><a href="/blog/tags/dogs/">Dogs (1)</a></li>
      </ol>
    </li>
  </ul>

  <ul>
    <li><h5 class="heading">Posts by Year</h5></li>
        <li><a href="/blog/2005">2005</a></li>
        <li><a href="/blog/2006">2006</a></li>
        <li><a href="/blog/2007">2007</a></li>
        <li><a href="/blog/2008">2008</a></li>
        <li><a href="/blog/2009">2009</a></li>
        <li><a href="/blog/2010">2010</a></li>
        <li><a href="/blog/2011">2011</a></li>
        <li><a href="/blog/2012">2012</a></li>
        <li><a href="/blog/2013">2013</a></li>
        <li><a href="/blog/2014">2014</a></li>
        <li><a href="/blog/2015">2015</a></li>
        <li><a href="/blog/2016">2016</a></li>
  </ul>
</sidebar>

</div>

<footer>
  Copyright 2005–2016 Drew Stephens
</footer>

<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-2474105-1', 'auto');
  ga('send', 'pageview');
</script>

</body>
</html>
